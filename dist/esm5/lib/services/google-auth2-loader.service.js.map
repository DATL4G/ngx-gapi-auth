{"version":3,"file":"google-auth2-loader.service.js","sourceRoot":"ng://ngx-gapi-auth2/","sources":["lib/services/google-auth2-loader.service.ts"],"names":[],"mappings":";;;;;AACA,OAAO,EAAE,UAAU,EAAE,MAAM,eAAe,CAAC;AAC3C,OAAO,EAAE,UAAU,EAAY,EAAE,EAAE,MAAM,MAAM,CAAC;AAChD,OAAO,EAAE,QAAQ,EAAE,MAAM,gBAAgB,CAAC;AAG1C,OAAO,EAAE,sBAAsB,EAAE,MAAM,6BAA6B,CAAC;AAGrE;IAIE,kCAAoB,SAAiC;QAArD,iBAIC;QAJmB,cAAS,GAAT,SAAS,CAAwB;QAF7C,eAAU,GAAe,SAAS,CAAC;QAGzC,IAAI,CAAC,SAAS,CAAC,MAAM,EAAE,CAAC,SAAS;;;QAAC;YAChC,KAAI,CAAC,eAAe,EAAE,CAAC,SAAS,EAAE,CAAC;QACrC,CAAC,EAAC,CAAC;IACL,CAAC;;;;;IAEM,0CAAO;;;;IAAd,UAAe,WAAmB;QAAlC,iBAMC;QANc,4BAAA,EAAA,mBAAmB;QAChC,IAAI,CAAC,IAAI,CAAC,UAAU,IAAI,WAAW,EAAE;YACnC,OAAO,IAAI,CAAC,SAAS,CAAC,MAAM,EAAE;iBAC3B,IAAI,CAAC,QAAQ;;;YAAC,cAAM,OAAA,KAAI,CAAC,eAAe,EAAE,EAAtB,CAAsB,EAAC,CAAC,CAAC;SACjD;QACD,OAAO,EAAE,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;IAC7B,CAAC;;;;;IAEO,kDAAe;;;;IAAvB;QAAA,iBAUC;QATC,OAAO,IAAI,UAAU;;;;QAAC,UAAC,QAA8B;YACnD,IAAI,CAAC,IAAI,CAAC,OAAO;;;YAAE;gBACjB,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,KAAI,CAAC,SAAS,CAAC,SAAS,EAAE,CAAC,eAAe,EAAE,CAAC,CAAC,IAAI;;;;gBAAC,UAAC,IAAgB;oBAClF,KAAI,CAAC,UAAU,GAAG,IAAI,CAAC;oBACvB,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;oBACpB,QAAQ,CAAC,QAAQ,EAAE,CAAC;gBACtB,CAAC,EAAC,CAAC,KAAK;;;;gBAAC,UAAC,GAAQ,IAAK,OAAA,QAAQ,CAAC,KAAK,CAAC,GAAG,CAAC,EAAnB,CAAmB,EAAC,CAAC;YAC9C,CAAC,EAAC,CAAC;QACL,CAAC,EAAC,CAAC;IACL,CAAC;;gBA5BF,UAAU;;;;gBAHF,sBAAsB;;IAgC/B,+BAAC;CAAA,AA7BD,IA6BC;SA5BY,wBAAwB;;;;;;IACnC,8CAA2C;;;;;IAE/B,6CAAyC","sourcesContent":["/// <reference types=\"gapi.auth2\" />\nimport { Injectable } from '@angular/core';\nimport { Observable, Observer, of } from 'rxjs';\nimport { mergeMap } from 'rxjs/operators';\n\nimport GoogleAuth = gapi.auth2.GoogleAuth;\nimport { GoogleApiLoaderService } from './google-api-loader.service';\n\n\n@Injectable()\nexport class GoogleAuth2LoaderService {\n  private GoogleAuth: GoogleAuth = undefined;\n\n  constructor(private googleApi: GoogleApiLoaderService) {\n    this.googleApi.onLoad().subscribe(() => {\n      this.loadGoogleAuth2().subscribe();\n    });\n  }\n\n  public getAuth(newInstance = false): Observable<GoogleAuth> {\n    if (!this.GoogleAuth || newInstance) {\n      return this.googleApi.onLoad()\n        .pipe(mergeMap(() => this.loadGoogleAuth2()));\n    }\n    return of(this.GoogleAuth);\n  }\n\n  private loadGoogleAuth2(): Observable<GoogleAuth> {\n    return new Observable((observer: Observer<GoogleAuth>) => {\n      gapi.load('auth2', () => {\n        gapi.auth2.init(this.googleApi.getConfig().getClientConfig()).then((auth: GoogleAuth) => {\n          this.GoogleAuth = auth;\n          observer.next(auth);\n          observer.complete();\n        }).catch((err: any) => observer.error(err));\n      });\n    });\n  }\n}\n"]}